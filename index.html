<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Abu Yusuf Alhamdy</title>
  <style>
    /* Reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Arial, sans-serif;
      display: flex;
      height: 100vh;
      background: #f0f0f0;
      color: #222;
      transition: background 0.3s, color 0.3s;
    }

    body.night-mode {
      background: #121212;
      color: #ddd;
    }

    #sidebar {
      width: 220px;
      background: #1a1a2e;
      color: #eee;
      display: flex;
      flex-direction: column;
      border-right: 3px solid #16213e;
      position: relative;
    }

    #sidebar nav {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    #sidebar nav a {
      padding: 18px 24px;
      color: #eee;
      text-decoration: none;
      border-left: 4px solid transparent;
      cursor: pointer;
      transition: background 0.3s, border-color 0.3s;
    }

    #sidebar nav a:hover,
    #sidebar nav a.active {
      background: #0f3460;
      border-left-color: #e94560;
    }

    #modeToggleContainer {
      padding: 12px 24px;
      border-top: 1px solid #333;
    }

    #modeToggle {
      width: 100%;
      background: transparent;
      border: none;
      color: #eee;
      font-size: 20px;
      cursor: pointer;
      user-select: none;
      outline: none;
    }

    #modeToggle:hover {
      color: #e94560;
    }

    #main {
      flex-grow: 1;
      padding: 24px;
      overflow-y: auto;
    }

    section.tab-content {
      display: none;
    }

    section.tab-content.active {
      display: block;
    }

    iframe {
      width: 100%;
      height: 360px;
      border: none;
      margin-top: 12px;
    }

    #videoList {
      display: grid;
      grid-template-columns: repeat(auto-fill,minmax(300px,1fr));
      gap: 16px;
      margin-top: 16px;
    }

    .video-item iframe {
      height: 180px;
    }

    .video-title {
      margin-top: 6px;
      font-size: 14px;
      color: inherit;
      font-weight: bold;
    }

    #videoSearch {
      width: 100%;
      padding: 8px 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 12px;
    }

    #videoSearch:focus {
      outline-color: #e94560;
      border-color: #e94560;
    }

    form input, form textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }

    form input:focus, form textarea:focus {
      outline-color: #e94560;
      border-color: #e94560;
    }

    form button {
      background: #e94560;
      border: none;
      padding: 12px;
      font-size: 16px;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }

    form button:hover {
      background: #b62e46;
    }

    #statusMessage {
      margin-top: 12px;
      font-weight: bold;
      color: #e94560;
    }

    /* Night mode adjustments */
    body.night-mode #sidebar {
      background: #0a0a14;
      border-right-color: #0f0f2f;
    }

    body.night-mode #sidebar nav a:hover,
    body.night-mode #sidebar nav a.active {
      background: #16213e;
      border-left-color: #ff3e57;
      color: #fff;
    }

    body.night-mode form input, 
    body.night-mode form textarea, 
    body.night-mode #videoSearch {
      background: #222;
      color: #ddd;
      border-color: #444;
    }

    body.night-mode form input:focus, 
    body.night-mode form textarea:focus, 
    body.night-mode #videoSearch:focus {
      outline-color: #ff3e57;
      border-color: #ff3e57;
    }
  </style>
</head>
<body>
  <div id="sidebar" role="navigation" aria-label="Main Navigation">
    <nav>
      <a href="#" data-tab="home" class="active" aria-current="page">Home</a>
      <a href="#" data-tab="articles">Articles</a>
      <a href="#" data-tab="videos">Videos</a>
      <a href="#" data-tab="contact">Contact Us</a>
    </nav>
    <div id="modeToggleContainer">
      <button id="modeToggle" aria-label="Toggle Day/Night mode" title="Toggle Day/Night mode">ðŸŒ™</button>
    </div>
  </div>

  <main id="main" tabindex="-1">
    <section id="home" class="tab-content active" aria-label="Home section">
      <h1>Welcome to Abu Yusuf Alhamdy</h1>
      <p>Your source for authentic Islamic knowledge with the Salafi manhaj.</p>
      <p>Check out the latest video below:</p>
      <div id="latestVideo" aria-live="polite" aria-busy="false">Loading latest video...</div>
    </section>

    <section id="articles" class="tab-content" aria-label="Articles section">
      <h2>Articles</h2>
      <p>Articles coming soon.</p>
    </section>

    <section id="videos" class="tab-content" aria-label="Videos section">
      <input type="text" id="videoSearch" placeholder="Search videos..." aria-label="Search videos" autocomplete="off" />
      <div id="videoList" aria-live="polite" aria-atomic="true">Loading videos...</div>
    </section>

    <section id="contact" class="tab-content" aria-label="Contact Us section">
      <h2>Contact Us</h2>
      <form id="contactForm" action="https://formspree.io/f/yourformid" method="POST" novalidate>
        <input type="text" name="name" placeholder="Your Name" required aria-required="true" autocomplete="name" />
        <input type="email" name="_replyto" placeholder="Your Email" required aria-required="true" autocomplete="email" />
        <textarea name="message" rows="5" placeholder="Your Message" required aria-required="true"></textarea>
        <button type="submit">Send</button>
      </form>
      <div id="statusMessage" role="alert" aria-live="assertive"></div>
    </section>
  </main>

  <script>
    // Sidebar tabs switching
    const tabs = document.querySelectorAll('#sidebar nav a');
    const contents = document.querySelectorAll('section.tab-content');
    tabs.forEach(tab => {
      tab.addEventListener('click', e => {
        e.preventDefault();
        const target = tab.dataset.tab;

        // Remove active from all tabs and contents
        tabs.forEach(t => {
          t.classList.remove('active');
          t.removeAttribute('aria-current');
        });
        contents.forEach(c => c.classList.remove('active'));

        // Activate clicked tab and matching content
        tab.classList.add('active');
        tab.setAttribute('aria-current', 'page');
        const content = document.getElementById(target);
        content.classList.add('active');
        content.focus();

        // Load videos or latest video on demand
        if (target === 'videos') loadVideos();
        if (target === 'home') loadLatestVideo();
      });
    });

    // Day/night mode toggle
    const modeToggle = document.getElementById('modeToggle');
    modeToggle.addEventListener('click', () => {
      document.body.classList.toggle('night-mode');
      const isNight = document.body.classList.contains('night-mode');
      modeToggle.textContent = isNight ? 'ðŸŒž' : 'ðŸŒ™';
    });

    // YouTube API info
    const apiKey = 'AIzaSyBxjceYQcKUaSwU12QLeu6meNmuIBunMng';
    const channelId = 'UCoXzWPTne8dHYrftHpdIopw';

    // Latest video container
    const latestVideoContainer = document.getElementById('latestVideo');

    async function loadLatestVideo() {
      latestVideoContainer.setAttribute('aria-busy', 'true');
      latestVideoContainer.textContent = 'Loading latest video...';
      try {
        const res = await fetch(`https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&part=snippet,id&order=date&maxResults=1&type=video`);
        const data = await res.json();
        if (data.items && data.items.length > 0) {
          const videoId = data.items[0].id.videoId;
          latestVideoContainer.innerHTML = `
            <iframe 
              src="https://www.youtube.com/embed/${videoId}" 
              allowfullscreen 
              title="Latest Video"
              loading="lazy"
            ></iframe>`;
        } else {
          latestVideoContainer.textContent = 'No videos found.';
        }
      } catch (error) {
        latestVideoContainer.textContent = 'Failed to load latest video.';
        console.error('Latest video error:', error);
      }
      latestVideoContainer.setAttribute('aria-busy', 'false');
    }

    // Video list & search
    const videoList = document.getElementById('videoList');
    const videoSearchInput = document.getElementById('videoSearch');
    let videoCache = [];

    async function loadVideos() {
      if (videoCache.length) {
        displayVideos(videoCache);
        return;
      }

      videoList.textContent = 'Loading videos...';

      try {
        // Get uploads playlist ID
        let res = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`);
        let data = await res.json();
        const playlistId = data.items[0].contentDetails.relatedPlaylists.uploads;

        // Get videos from uploads playlist
        res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${playlistId}&maxResults=50&key=${apiKey}`);
        data = await res.json();

        videoCache = data.items.map(item => ({
          id: item.snippet.resourceId.videoId,
          title: item.snippet.title
        }));

        displayVideos(videoCache);
      } catch (error) {
        videoList.textContent = 'Failed to load videos.';
        console.error('Videos load error:', error);
      }
    }

    function displayVideos(videos) {
      videoList.innerHTML = '';
      if (!videos.length) {
        videoList.textContent = 'No videos found.';
        return;
      }
      videos.forEach(video => {
        const div = document.createElement('div');
        div.className = 'video-item';
        div.innerHTML = `
          <iframe 
            src="https://www.youtube.com/embed/${video.id}" 
            allowfullscreen 
            title="${video.title}"
            loading="lazy"
          ></iframe>
          <div class="video-title">${video.title}</div>
        `;
        videoList.appendChild(div);
      });
    }

    videoSearchInput.addEventListener('input', () => {
      const searchTerm = videoSearchInput.value.trim().toLowerCase();
      if (!searchTerm) {
        displayVideos(videoCache);
        return;
      }
      const filtered = videoCache.filter(v => v.title.toLowerCase().includes(searchTerm));
      displayVideos(filtered);
    });

    // Contact form submit handler
    const contactForm = document.getElementById('contactForm');
    const statusMessage = document.getElementById('statusMessage');

    contactForm.addEventListener('submit', async e => {
      e.preventDefault();
      statusMessage.style.color = '#e94560';
      statusMessage.textContent = 'Sending...';

      const formData = new FormData(contactForm);
      try {
        const res = await fetch(contactForm.action, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        });

        if (res.ok) {
          statusMessage.style.color = 'limegreen';
          statusMessage.textContent = 'Message sent successfully!';
          contactForm.reset();
        } else {
          statusMessage.textContent = 'Failed to send message.';
        }
      } catch (error) {
        statusMessage.textContent = 'Network error. Try again later.';
        console.error('Contact form error:', error);
      }
    });

    // Load latest video immediately on page load
    loadLatestVideo();
  </script>
</body>
</html>
